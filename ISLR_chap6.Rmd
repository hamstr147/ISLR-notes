---
title: "ISLR Chapter 6 solutions"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(leaps)
```

## Exercise 8

Create a vector $X$ as a predictor and a noise vector $\epsilon$:
```{r}
x <- rnorm(100, mean = 10, sd = 2)
eps <- rnorm(100)
```

Construct a response vector $Y$ according to the model:
$$
Y=10+2X+4X^2+3X^3+\epsilon 
$$
```{r}
y <- 10 + 2*x + 4*x^2 + 3*x^3 + eps
```

Now try best subsets on predictors $X$, $X^2$ ... $X^{10}$:
```{r}
mydata <- data.frame(x, y)
reg.fit <- regsubsets(y ~ poly(x, 10), data = mydata)
reg.summary <- summary(reg.fit)

par(mfrow=c(2,2))
plot(reg.summary$adjr2, type = "l")
which.max(reg.summary$adjr2)
points(6,reg.summary$adjr2[6], col="red",cex=2,pch=20)
```

